<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>（Linux）日志、计划任务、主机名、系统时间 | 个人笔记</title>
<meta name="description" content="个人笔记">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://bingery111.github.io/favicon.ico?v=1644900079864">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://bingery111.github.io/styles/main.css">


<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://bingery111.github.io">个人笔记</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                首页
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                归档
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                标签
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                关于
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>（Linux）日志、计划任务、主机名、系统时间</h1>
            <p class="article-meta">
              2022-02-15
              
            </p>
            
            <div class="post-content">
              <ul>
<li><a href="#%E4%B8%80%E6%97%A5%E5%BF%97">一、日志</a>
<ul>
<li><a href="#1rsyslog%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6">1、rsyslog日志文件</a></li>
<li><a href="#2%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB">2、日志级别</a></li>
<li><a href="#3%E6%9F%A5%E7%9C%8Bsystemd%E6%97%A5%E5%BF%97">3、查看systemd日志</a></li>
<li><a href="#4%E4%BF%9D%E5%AD%98systemd%E6%97%A5%E5%BF%97">4、保存systemd日志</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8Cred-hat7%E4%B8%AD%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4">二、Red Hat7中查看系统时间</a></li>
<li><a href="#%E4%B8%89%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1">三、计划任务</a></li>
<li><a href="#%E5%9B%9B%E4%B8%BB%E6%9C%BA%E5%90%8D">四、主机名</a></li>
<li><a href="#%E4%BA%94%E8%AF%B4%E6%98%8E">五、说明</a></li>
</ul>
<h2 id="一-日志">一、日志</h2>
<p>进程和操作系统内核需要能够为发生的事情记录日志，这些日志可用于系统审核和问题的故障排除。按照管理，这些日志永久存储在/var/log。</p>
<p>在Red Hat7版本中，有两个日志服务，分别是rsyslog和systemd-journal。</p>
<p>systemd-journal是一种改进型的日志管理服务，可以收集来自内核、启动过程的早期阶段、标准输出、系统日志，以及守护进程启动和运行期间错误的消息。它将这些消息写入到一个结构化事件中，默认情况向下并不会持久化保存日志，每次重启之后，之前的日志都会丢失。另外，一些rsyslog无法收集的日志也会被写入systemd-journal。</p>
<h3 id="1-rsyslog日志文件">1、rsyslog日志文件</h3>
<p><strong>rsyslog把收集到的日志都记录在/var/log目录下的各个日志文件中。</strong></p>
<div align=center><img src='https://mmbiz.qpic.cn/mmbiz_png/cu0TUlMDjbsehyp13PialMAOgiaKUKF6RdUng6OTcxHNgOL8xFJ0YUvawaWa3Yb6um0Y4UWT2Q6paZ2e8taun5WA/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1' width="50%" height="50%"></div>
<p align=center>(常见的日志文件)</p>
<p>systemctl status rsyslog   查看rsyalog服务是否运行；其配置文件在  /etc/rsyslog.conf，每一个日志类型，记录某一类的日志到某个文件中。</p>
<h3 id="2-日志级别">2、日志级别</h3>
<table>
<thead>
<tr>
<th style="text-align:left">编号</th>
<th style="text-align:left">优先级</th>
<th style="text-align:left">严重性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">emerg</td>
<td style="text-align:left">系统不可用</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">alert</td>
<td style="text-align:left">必须立即采取措施</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">crit</td>
<td style="text-align:left">严重状况</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">err</td>
<td style="text-align:left">非常严重的错误状况</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">warning</td>
<td style="text-align:left">警告</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">notice</td>
<td style="text-align:left">正常但重要的事件</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">info</td>
<td style="text-align:left">信息性事件</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left">debug</td>
<td style="text-align:left">调试级别消息</td>
</tr>
</tbody>
</table>
<p>查看rsyslog配置文件：vim /etc/rsyslog.conf。</p>
<p><em><strong>凡是修改过配置文件的，都必须重启。</strong></em></p>
<h3 id="3-查看systemd日志">3、查看systemd日志</h3>
<p>查看systemd日志条目  专门的命令 journalctl。</p>
<p>journalctl 用来查看所有的日志</p>
<div align=center><img src='https://mmbiz.qpic.cn/mmbiz_png/cu0TUlMDjbsehyp13PialMAOgiaKUKF6RdAD4AGeGgpku7bau1PymSPLJn3Gxric2WFoIpvgu5vo9Fb3CLXmJD4ibQ/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1' width="50%" height="50%"></div>
<p align=center>(查看所有日志)</p>
<p>journalctl -n [NUM] 默认显示最后10个日志条目</p>
<div align=center><img src='https://mmbiz.qpic.cn/mmbiz_png/cu0TUlMDjbsehyp13PialMAOgiaKUKF6Rd3q4b8ZqwaZf13jUgR3DNDJRcMPUHqAAuO7kkWCutNeNyWZNYU9rItQ/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1' width="50%" height="50%"></div>
<p align=center>(查看最后10条日志)</p>
<p>journalctl -p err  过滤日志级别输出</p>
<div align=center><img src='https://mmbiz.qpic.cn/mmbiz_png/cu0TUlMDjbsehyp13PialMAOgiaKUKF6RdRiaWl4FF0WOx5lUxicoBMqRjXlCdSpZMQfuxyXStDwKVsdqeFvzibDRgg/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1' width="50%" height="50%"></div>
<p align=center>(日志级别过滤输出)</p>
<p>还可以输出具体时间范围，两个选项-since和-until，接受的时间格式为YYY-MM-DD hh:mm:ss,如果省略日期，则命令会假定为当天的日期；如果省略时间，则假定为00:00:00，除了具体的日期时间外，这两个选项还接受yesterday，today，tomorrow。</p>
<h3 id="4-保存systemd日志">4、保存systemd日志</h3>
<p>一般情况下保存在/etc/log/journal,这样就可以实现持久化systemd日志，但是默认情况下只会保存一个月的日志信息，可在配置文件/etc/systemd/journald.conf中调节。</p>
<div align=center><img src='https://mmbiz.qpic.cn/mmbiz_png/cu0TUlMDjbsehyp13PialMAOgiaKUKF6RdcZXI8USfnFxTPGWQaN1DAic0pIRLibW8lVp8mcfCbTFZlnOEt7Zibz19g/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1' width="50%" height="50%"></div>
<p align=center>(默认保存一个月)</p>
<h2 id="二-red-hat7中查看系统时间">二、Red Hat7中查看系统时间</h2>
<p>配置文件在/etc/chrony.confz中。</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">timedatectl</td>
<td style="text-align:left">查看系统时间</td>
</tr>
<tr>
<td style="text-align:left">timedatectl list-timezones</td>
<td style="text-align:left">列出时区信息</td>
</tr>
<tr>
<td style="text-align:left">timedatectl set-timezone Asia/Shanghai</td>
<td style="text-align:left">设置时区</td>
</tr>
<tr>
<td style="text-align:left">timedatectl set-time 22:19:00[YYY-MM-DD hh:mm:ss]</td>
<td style="text-align:left">设置时间日期</td>
</tr>
<tr>
<td style="text-align:left">timedatectl set-ntp[true</td>
<td style="text-align:left">false]</td>
</tr>
</tbody>
</table>
<h2 id="三-计划任务">三、计划任务</h2>
<ol>
<li>在未来的某个时间点执行一次某任务，相关命令：at  比较简单，不再多说。</li>
<li>周期性的执行某任务
<ul>
<li>cron: 自身是一个不间断运行的服务；</li>
<li>对cron任务来说，分两类：系统cron任务，与用户无关，是系统周期性的维护，格式：分钟 小时 日 月 周 用户 任务；</li>
</ul>
</li>
</ol>
<p>用户cron任务：通常定义在/var/spool/cron/USERNAME目录下，格式：分钟 小时 日 月 周 任务。</p>
<p>时间的有效值：</p>
<blockquote>
<p>分钟   0-59</p>
<p>小时   0-23</p>
<p>日    1-31</p>
<p>月    1-12</p>
<p>周    0-7 :0和7都表示周日</p>
</blockquote>
<p>时间通配符：</p>
<ul>
<li>*   对应的所有有效值</li>
<li>\，  离散时间点取值</li>
<li>-   连续的时间点</li>
<li>/   对应取值范围内每多久一次</li>
</ul>
<p>用户cron任务的管理，crontab该命令可以实现对语法的检测：</p>
<p>选项|解释<br>
-l|列出当前用户的cron任务<br>
-e|编辑当前用户的cron任务<br>
-r|移除所有的cron任务<br>
-u USERNAME|管理其他用户的cron,只有root可用</p>
<h2 id="四-主机名">四、主机名</h2>
<ul>
<li>hostname   查看主机名；</li>
<li>hostname &quot;HOSTNAME&quot;   临时修改主机名；</li>
</ul>
<p>静态主机名保存在/etc/hostname文件中，hostnamectl可以修改此文件。</p>
<p>hostnamectl set-hostname HOSTNAME   永久修改主机名；</p>
<p>有个名称解析：用于将主机名转换为IP地址，反之亦可。</p>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                下一篇
              </div>
              <a href="https://bingery111.github.io/post/linuxyong-hu-huan-jing/">
                <h3 class="post-title">
                  （Linux）用户环境
                </h3>
              </a>
            </div>
          
        </div>
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://bingery111.github.io/images/avatar.png?v=1644900079864" class="no-responsive avatar">
    <div class="text-muted">个人笔记</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      最新文章
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://bingery111.github.io/post/yan-jiu-fang-ddos-gong-ji/">（研究）防DDoS攻击</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linuxri-zhi-ji-hua-ren-wu-zhu-ji-ming-xi-tong-shi-jian/">（Linux）日志、计划任务、主机名、系统时间</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linuxyong-hu-huan-jing/">（Linux）用户环境</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linuxshou-hu-jin-cheng-he-yuan-cheng-deng-lu-fu-wu-qi/">（Linux）守护进程和远程登陆服务器</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linuxwen-jian-he-yong-hu-zu/">（Linux）文件和用户组</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linux-wang-luo-pei-zhi/">（Linux）网络配置</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linux-jin-cheng/">（Linux）进程</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linux-targrep-ming-ling/">（Linux）tar/grep命令</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/linux-ruan-ying-lian-jie-ji-chong-ding-xiang/">（Linux）软硬链接及重定向</a>
            </li>
          
        
          
            <li>
              <a href="https://bingery111.github.io/post/lesslesssuan-fa-dao-lun-greatergreater-yan-du/">《算法导论》研读</a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      标签列表
    </div>
    <div class="row">
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://bingery111.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>




  </body>
</html>
